language: node_js
node_js:
- '5'
cache:
  directories: node_modules
sudo: required
services:
- docker
before_install:
- npm prune
- hooks/travis/before_install.sh
- make login
install:
- make build
- make dist
before_script:
- make start-d
script:
- make unittest
- make systemtest
- make smoketest
after_script:
- make stop-all
- '[ "${TRAVIS_PULL_REQUEST}" = "false" ] && docker/semantic-release.sh && make push && scripts/notify_dependencies.sh'
branches:
  only:
  - master
  - stable
